# テーマ3: ロジスティックマップ

## 目的

生物の個体数をモデル化し、カオスを実感する。

## モデル

ある時刻の生物の個体数の多さを$n_i$としよう。この生物は、

次の時刻の個体数$n_{i+1}$が、$n_i$を使って、

$$
n_{i+1} = a (1 - n_i) n_i
$$

と表現できるとする。$a$は生物にとっての環境の快適度を表し、小さいと生物はあまり増えられず、大きいと生物は増えやすい。

## プログラム

### 最初のセル

最初のセルはライブラリのインポートを行う。

```py
import matplotlib.pyplot as plt
```

### 2番目のセル

最初に`a = 1.0`の時にどうなるかを見てみよう。以下を入力、実行してみよう。

```py
n = 0.01
a = 1.0
y = []
for i in range(100):
    y.append(n)
    n = a * n * (1.0 - n)
plt.ylim(0,1)
plt.plot(y)
```

個体数が0に張り付いたようなグラフが得られるはずだ。

次に$a=2.0$に書き換えて、もう一度実行してみよう。こんどは個体数が$0.5$になるだろう。

では次に$a=3.0$ではどうだろう。$a=3.3$では？

### 3番目のセル

```py
a_s = 1.0
a_e = 3.3
N = 1000
x = []
y = []
for i in range(N):
    a = a_s + (a_e - a_s)/N*i
    n = 0.1
    for i in range(1000):
        n = a * n * (1.0 - n)
        if i > 900:
            x.append(a)
            y.append(n)
plt.scatter(x,y, s=0.01)
```

これを実行すると、パラメータ`a`に対して、最終的に個体数がどこに落ち着くかをプロットするものだ。

## 数学的背景

ある生物を考えよう。この生物は一定時間ごとに増えていく。例えば、毎回$a$倍に増えるとしよう。その生物が、時刻$i$に$N_i$匹いたとするなら、時刻$i+1$には$a N_i$になる。

これだけでは、この生物は指数関数的に増えていくだけだが、そのうち餌が足りなくなって増えることができなくなるだろう。子供を産むことができる限界の個体数を$N_\mathrm{max}$としよう。個体数が多い時に増えることができない効果を取り込んで、倍率を$a (1.0 - N_i/N_\mathrm{max})$と書き換えよう。この式は、個体数が少ないときには$a$倍に増えられるが、最大値に近い場合は倍率が0、すなわち増えすぎて子供が作れなくなって個体数が減る効果を表している。すると、個体数を表す式は、

$$
N_{i+1} = a \left(1.0 - \frac{N_i}{N_\mathrm{max}} \right) N_i
$$

となる。両辺を$N_\mathrm{max}$で割ると、

$$
\frac{N_{i+1}}{N_\mathrm{max}} = a \left(1.0 - \frac{N_i}{N_\mathrm{max}} \right) \frac{N_i}{N_\mathrm{max}}
$$

$N_i/N_\mathrm{max}$を$n_i$と書き直すと、

$$
n_{i+1} = a (1 - n_i) n_i
$$

これがロジスティックマップである。$n_i = N_i/N_\mathrm{max}$は、環境が許す最大の個体数のうち、現在どのくらいの個体数がいるかの割合を表していることがわかる。
